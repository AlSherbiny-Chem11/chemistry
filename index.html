<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø§Ù„Ø´Ø±Ø¨ÙŠÙ†ÙŠ Ù„Ù„ÙƒÙŠÙ…ÙŠØ§Ø¡ | Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ v6.0</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;700;900&display=swap');
        
        :root {
            --royal-gold: #c5a059;
            --deep-blue: #0f172a;
            --soft-gold: rgba(197, 160, 89, 0.2);
        }

        body {
            font-family: 'Cairo', sans-serif;
            background: radial-gradient(circle at top, #1e293b 0%, #0f172a 100%);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¦ÙŠØ© ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ© */
        .bg-pattern {
            position: fixed;
            inset: 0;
            background-image: url('https://www.transparenttextures.com/patterns/carbon-fibre.png');
            opacity: 0.15;
            z-index: -1;
        }

        /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ø²Ø¬Ø§Ø¬ (Glassmorphism) */
        .glass {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 24px;
        }

        /* Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ø§Ù„Ø¸Ù‡ÙˆØ± */
        .fade-in { animation: fadeIn 0.8s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Ø²Ø± Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ù„ÙƒÙŠ */
        .btn-gold {
            background: linear-gradient(135deg, #c5a059 0%, #edd3a1 100%);
            color: #0f172a;
            transition: 0.3s;
            box-shadow: 0 10px 20px rgba(197, 160, 89, 0.2);
        }
        .btn-gold:active { transform: scale(0.96); }

        /* ØªØ®ØµÙŠØµ Ø§Ù„Ø³ÙƒØ±ÙˆÙ„ Ø¨Ø§Ø± */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: var(--royal-gold); border-radius: 10px; }
    </style>
</head>
<body>
    <div class="bg-pattern"></div>

    <section id="auth-screen" class="fixed inset-0 z-[9999] flex items-center justify-center bg-[#0f172a]">
        <div class="text-center p-8 w-full max-w-sm fade-in">
            <div class="w-24 h-24 bg-[#c5a059] rounded-[32px] mx-auto mb-6 flex items-center justify-center shadow-[0_0_40px_rgba(197,160,89,0.4)] rotate-3">
                <i class="fas fa-atom text-slate-900 text-5xl"></i>
            </div>
            <h1 class="text-3xl font-black mb-2 tracking-tight">Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø§Ù„Ø´Ø±Ø¨ÙŠÙ†ÙŠ</h1>
            <p class="text-slate-400 mb-10 font-medium">Ù†Ø¸Ø§Ù… Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¡ Ø§Ù„Ø°ÙƒÙŠ 2026</p>
            <button onclick="login()" class="btn-gold w-full py-5 rounded-3xl flex items-center justify-center gap-3 font-black text-lg">
                <i class="fab fa-google"></i> ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø·Ù„Ø§Ø¨
            </button>
        </div>
    </section>

    <header id="app-header" class="hidden sticky top-0 z-[1000] border-b border-white/5 bg-[#0f172a]/80 backdrop-blur-xl">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="relative group">
                <img id="user-avatar" onclick="toggleMenu()" class="w-11 h-11 rounded-xl border-2 border-[#c5a059] cursor-pointer hover:rotate-3 transition">
                <div id="drop-menu" class="hidden absolute top-14 right-0 w-60 glass p-2 shadow-2xl animate-show">
                    <div class="p-4 border-b border-white/5 mb-2">
                        <p class="text-[10px] text-slate-400 font-bold">Ø·Ø§Ù„Ø¨ Ù…Ø³Ø¬Ù„</p>
                        <p id="user-name-display" class="font-bold text-sm truncate"></p>
                    </div>
                    <button onclick="openPicker()" class="w-full text-right p-3 hover:bg-white/5 rounded-xl text-sm font-bold"><i class="fas fa-layer-group ml-2 text-[#c5a059]"></i> ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ØµÙ</button>
                    <button onclick="adminCheck()" class="w-full text-right p-3 hover:bg-red-500/10 rounded-xl text-sm font-bold text-red-400"><i class="fas fa-user-crown ml-2"></i> Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯Ø±Ø³</button>
                    <button onclick="logout()" class="w-full text-right p-3 hover:bg-white/5 rounded-xl text-sm font-bold text-slate-500"><i class="fas fa-sign-out-alt ml-2"></i> Ø®Ø±ÙˆØ¬</button>
                </div>
            </div>
            <div class="text-center">
                <span id="grade-info" class="bg-[#c5a059]/10 text-[#c5a059] px-4 py-1 rounded-lg text-[10px] font-black border border-[#c5a059]/30">ØªØ­Ù…ÙŠÙ„...</span>
            </div>
            <h2 class="font-black text-xl tracking-tighter">Ø§Ù„Ø´Ø±Ø¨ÙŠÙ†ÙŠ <span class="text-[#c5a059]">Academy</span></h2>
        </div>
    </header>

    <div id="grade-picker" class="fixed inset-0 z-[8000] bg-[#0f172a] hidden flex flex-col items-center justify-center p-6">
        <h3 class="text-2xl font-black mb-12 text-white">Ø§Ø®ØªØ± Ø³Ù†ØªÙƒ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ© ğŸ“</h3>
        <div class="grid grid-cols-2 md:grid-cols-3 gap-5 w-full max-w-4xl">
            <div onclick="saveGrade('1-mid', 'Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ')" class="glass p-6 text-center cursor-pointer hover:border-[#c5a059] transition group">
                <div class="w-12 h-12 bg-white/5 rounded-full mx-auto mb-3 flex items-center justify-center group-hover:bg-[#c5a059]/20"><i class="fas fa-book-open text-blue-400"></i></div>
                <p class="font-bold">Ø£ÙˆÙ„Ù‰ Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ</p>
            </div>
            <div onclick="saveGrade('2-mid', 'Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ')" class="glass p-6 text-center cursor-pointer hover:border-[#c5a059] transition group">
                <div class="w-12 h-12 bg-white/5 rounded-full mx-auto mb-3 flex items-center justify-center group-hover:bg-[#c5a059]/20"><i class="fas fa-flask text-blue-400"></i></div>
                <p class="font-bold">ØªØ§Ù†ÙŠØ© Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ</p>
            </div>
            <div onclick="saveGrade('3-mid', 'Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ')" class="glass p-6 text-center cursor-pointer hover:border-[#c5a059] transition group">
                <div class="w-12 h-12 bg-white/5 rounded-full mx-auto mb-3 flex items-center justify-center group-hover:bg-[#c5a059]/20"><i class="fas fa-microscope text-blue-400"></i></div>
                <p class="font-bold">ØªØ§Ù„ØªØ© Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ</p>
            </div>
            <div onclick="saveGrade('1-sec', 'Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ')" class="glass p-6 text-center cursor-pointer border-[#c5a059]/30 hover:border-[#c5a059] transition group">
                <div class="w-12 h-12 bg-[#c5a059]/5 rounded-full mx-auto mb-3 flex items-center justify-center group-hover:bg-[#c5a059]/20"><i class="fas fa-atom text-amber-500"></i></div>
                <p class="font-bold text-[#c5a059]">Ø£ÙˆÙ„Ù‰ Ø«Ø§Ù†ÙˆÙŠ</p>
            </div>
            <div onclick="saveGrade('2-sec', 'Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ')" class="glass p-6 text-center cursor-pointer border-[#c5a059]/30 hover:border-[#c5a059] transition group">
                <div class="w-12 h-12 bg-[#c5a059]/5 rounded-full mx-auto mb-3 flex items-center justify-center group-hover:bg-[#c5a059]/20"><i class="fas fa-dna text-amber-500"></i></div>
                <p class="font-bold text-[#c5a059]">ØªØ§Ù†ÙŠØ© Ø«Ø§Ù†ÙˆÙŠ</p>
            </div>
            <div onclick="saveGrade('3-sec', 'Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ')" class="glass p-6 text-center cursor-pointer border-[#c5a059]/30 hover:border-[#c5a059] transition group">
                <div class="w-12 h-12 bg-[#c5a059]/5 rounded-full mx-auto mb-3 flex items-center justify-center group-hover:bg-[#c5a059]/20"><i class="fas fa-brain text-amber-500"></i></div>
                <p class="font-bold text-[#c5a059]">ØªØ§Ù„ØªØ© Ø«Ø§Ù†ÙˆÙŠ</p>
            </div>
        </div>
    </div>

    <main id="app-content" class="hidden container mx-auto px-6 py-10">
        <h3 class="text-2xl font-black mb-8 pr-4 border-r-4 border-[#c5a059]">Ø¢Ø®Ø± Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª Ø§Ù„Ù…Ø±ÙÙˆØ¹Ø©</h3>
        <div id="video-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            </div>
    </main>

    <div id="admin-panel" class="fixed inset-0 z-[9000] bg-black/95 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-[32px] w-full max-w-lg p-8 text-slate-900 fade-in">
            <h3 class="text-2xl font-black mb-2">Ø¥Ø¶Ø§ÙØ© Ø¯Ø±Ø³ Ø¬Ø¯ÙŠØ¯</h3>
            <p class="text-red-500 text-xs font-bold mb-6 italic underline">Ø®Ø§Øµ ÙÙ‚Ø· Ø¨Ø§Ù„Ø£Ø³ØªØ§Ø° Ù…Ø­Ù…Ø¯ Ø§Ù„Ø´Ø±Ø¨ÙŠÙ†ÙŠ</p>
            <div class="space-y-4">
                <input type="text" id="v-title" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯Ø±Ø³" class="w-full p-4 bg-slate-100 rounded-2xl outline-none focus:ring-2 ring-[#c5a059]">
                <input type="text" id="v-url" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ÙŠÙˆØªÙŠÙˆØ¨" class="w-full p-4 bg-slate-100 rounded-2xl outline-none focus:ring-2 ring-[#c5a059]">
                <select id="v-grade" class="w-full p-4 bg-slate-100 rounded-2xl outline-none font-bold">
                    <option value="1-mid">Ø£ÙˆÙ„Ù‰ Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ</option>
                    <option value="2-mid">ØªØ§Ù†ÙŠØ© Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ</option>
                    <option value="3-mid">ØªØ§Ù„ØªØ© Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ</option>
                    <option value="1-sec">Ø£ÙˆÙ„Ù‰ Ø«Ø§Ù†ÙˆÙŠ</option>
                    <option value="2-sec">ØªØ§Ù†ÙŠØ© Ø«Ø§Ù†ÙˆÙŠ</option>
                    <option value="3-sec">ØªØ§Ù„ØªØ© Ø«Ø§Ù†ÙˆÙŠ</option>
                </select>
                <button id="pub-btn" onclick="publish()" class="btn-gold w-full py-5 rounded-2xl font-black text-slate-900 shadow-xl">Ù†Ø´Ø± Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¢Ù† Ù„Ù„Ø·Ù„Ø§Ø¨ ğŸš€</button>
                <button onclick="closeAdmin()" class="w-full text-slate-400 font-bold text-sm">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAyIsaApHUjEQWJgGhCom25pUj8Bm9LYyQ",
            authDomain: "sherbiny-academy.firebaseapp.com",
            projectId: "sherbiny-academy",
            storageBucket: "sherbiny-academy.firebasestorage.app",
            messagingSenderId: "349228281326",
            appId: "1:349228281326:web:ffbbf1eb5927b50d13f2ff"
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        let activeGrade = localStorage.getItem('s_grade');

        auth.onAuthStateChanged(user => {
            if (user) {
                document.getElementById('auth-screen').style.display = 'none';
                document.getElementById('app-header').classList.remove('hidden');
                document.getElementById('app-content').classList.remove('hidden');
                document.getElementById('user-avatar').src = user.photoURL;
                document.getElementById('user-name-display').innerText = user.displayName;
                if(!activeGrade) openPicker(); else saveGrade(activeGrade, getGradeText(activeGrade));
            } else {
                document.getElementById('auth-screen').style.display = 'flex';
            }
        });

        async function login() {
            const provider = new firebase.auth.GoogleAuthProvider();
            try { await auth.signInWithPopup(provider); } catch(e) { auth.signInWithRedirect(provider); }
        }

        function logout() { auth.signOut(); localStorage.removeItem('s_grade'); }
        function openPicker() { document.getElementById('grade-picker').classList.remove('hidden'); }
        function toggleMenu() { document.getElementById('drop-menu').classList.toggle('hidden'); }

        function saveGrade(id, name) {
            activeGrade = id;
            localStorage.setItem('s_grade', id);
            document.getElementById('grade-info').innerText = name;
            document.getElementById('grade-picker').classList.add('hidden');
            loadContent(id);
        }

        function getGradeText(id) {
            const map = {'1-mid':'Ø£ÙˆÙ„Ù‰ Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ','2-mid':'ØªØ§Ù†ÙŠØ© Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ','3-mid':'ØªØ§Ù„ØªØ© Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ','1-sec':'Ø£ÙˆÙ„Ù‰ Ø«Ø§Ù†ÙˆÙŠ','2-sec':'ØªØ§Ù†ÙŠØ© Ø«Ø§Ù†ÙˆÙŠ','3-sec':'ØªØ§Ù„ØªØ© Ø«Ø§Ù†ÙˆÙŠ'};
            return map[id] || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯";
        }

        function loadContent(gradeId) {
            const grid = document.getElementById('video-grid');
            grid.innerHTML = '<p class="col-span-full text-center py-20 opacity-50">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª...</p>';
            
            // ÙÙ„ØªØ±Ø© Ø­Ù‚ÙŠÙ‚ÙŠØ© Ù„Ù„ØµÙÙˆÙ
            db.collection("lessons").where("grade", "==", gradeId).onSnapshot(snap => {
                let h = "";
                let docs = [];
                snap.forEach(d => docs.push(d.data()));
                
                // ØªØ±ØªÙŠØ¨ ÙŠØ¯ÙˆÙŠ Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ø§Ù‹ Ø¨Ø¯ÙˆÙ† Ø£Ø®Ø·Ø§Ø¡ Index
                docs.sort((a, b) => (b.createdAt?.seconds || 0) - (a.createdAt?.seconds || 0));

                docs.forEach(data => {
                    h += `
                        <div class="glass p-4 fade-in overflow-hidden group">
                            <div class="h-44 bg-slate-900 rounded-2xl mb-4 flex items-center justify-center relative">
                                <i class="fas fa-play-circle text-white/5 text-6xl group-hover:text-[#c5a059]/20 transition"></i>
                                <span class="absolute bottom-3 left-3 bg-[#c5a059] text-slate-900 text-[8px] font-black px-2 py-1 rounded">LECTURE</span>
                            </div>
                            <h4 class="font-bold text-sm mb-4 h-10 overflow-hidden leading-relaxed">${data.title}</h4>
                            <button onclick="window.open('${data.url}')" class="w-full py-3 bg-white/5 border border-white/10 rounded-xl text-xs font-bold hover:bg-[#c5a059] hover:text-slate-900 transition">Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</button>
                        </div>
                    `;
                });
                grid.innerHTML = h || `<div class="col-span-full py-20 text-center opacity-20 font-black">Ù‚Ø±ÙŠØ¨Ø§Ù‹ Ù…Ø­Ø§Ø¶Ø±Ø§Øª ${getGradeText(gradeId)}</div>`;
            });
        }

        function adminCheck() { if(prompt("ÙƒÙˆØ¯ Ø§Ù„Ù…Ø¯Ø±Ø³:") === "123") document.getElementById('admin-panel').classList.remove('hidden'); }
        function closeAdmin() { document.getElementById('admin-panel').classList.add('hidden'); }

        async function publish() {
            const t = document.getElementById('v-title').value;
            const u = document.getElementById('v-url').value;
            const g = document.getElementById('v-grade').value;
            const b = document.getElementById('pub-btn');
            if(!t || !u) return alert("Ø§ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
            
            b.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...";
            b.disabled = true;

            try {
                await db.collection("lessons").add({ title: t, url: u, grade: g, createdAt: firebase.firestore.FieldValue.serverTimestamp() });
                alert("ØªÙ… Ø§Ù„Ù†Ø´Ø± Ø¨Ù†Ø¬Ø§Ø­ âœ…");
                closeAdmin();
            } catch(e) { alert("Ø­Ø¯Ø« Ø®Ø·Ø£"); }
            finally { b.innerText = "Ù†Ø´Ø± Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¢Ù† ğŸš€"; b.disabled = false; }
        }
    </script>
</body>
</html>
